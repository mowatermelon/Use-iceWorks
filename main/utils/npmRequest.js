const e=require("request"),r=require("semver"),s=require("../services/settings"),n=require("../logger");module.exports=function({name:t,version:i="latest",registry:o}){const u=s.get("registry");let g=o||u||"https://registry.npmjs.com";const l=`${g=g.replace(/\/$/,"")}/${t.replace(/\//g,"%2f")}`;return n.debug("npmRequest",l),new Promise((s,n)=>{e({url:l,json:!0},(e,o,u)=>{e||!u?n(e||new Error(JSON.stringify(o.body))):(r.valid(i)||(i=u["dist-tags"][i]),r.valid(i)&&u&&u.versions&&u.versions[i]?s(u.versions[i]):n(new Error(`Can not found version ${i} of ${t}`)))})})};