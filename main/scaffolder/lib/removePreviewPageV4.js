const e=require("fs"),r=require("path"),i=require("babylon"),n=require("babel-generator").default,t=require("babel-traverse").default,o=require("babel-types"),a=require("rimraf"),s=require("prettier"),u=require("../../config");function l(r){const n=e.readFileSync(r).toString();return i.parse(n,{sourceType:"module",plugins:["*"]})}const c="routerConfig",d="asideMenuConfig",p="/IceworksPreviewPage",m="./pages/IceworksPreviewPage";module.exports=async function({destDir:i}){const f=r.join(i,"src/pages/IceworksPreviewPage");a.sync(f);const g=r.join(i,"src/routerConfig.js"),y=l(g);t(y,{VariableDeclarator(e){o.isIdentifier(e.node.id,{name:c})&&o.isArrayExpression(e.node.init)&&(e.node.init.elements=e.node.init.elements.filter(e=>{return!e.properties.some(e=>"path"===e.key.name&&e.value.value===p)}))},ImportDeclaration(e){o.isStringLiteral(e.node.source,{value:m})&&e.remove()}}),e.writeFileSync(g,s.format(n(y).code,u.prettier));const b=r.join(i,"src/menuConfig.js"),v=l(b);t(v,{VariableDeclarator(e){o.isIdentifier(e.node.id,{name:d})&&o.isArrayExpression(e.node.init)&&(e.node.init.elements=e.node.init.elements.filter(e=>{return!e.properties.some(e=>"path"===e.key.name&&e.value.value===p)}))}}),e.writeFileSync(b,s.format(n(v).code,u.prettier))};