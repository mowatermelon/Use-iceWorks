const e=require("./generate-project"),t=require("../../logger"),o=require("../npm"),r=require("../interaction"),{notify:a}=r;class s{add({data:r,path:s},n){const i=Object.assign({},{targetPath:s,scaffold:r.scaffold,projectName:r.projectName});Promise.resolve(e(i)).then(()=>r.installDeps?new Promise((e,r)=>{let a="";const n=o.fork(["install","--no-package-lock"],{cwd:s});n.stdout.on("data",e=>{t.debug((e+"").trim()),a+=e}),n.stderr.on("data",e=>{t.debug((e+"").trim()),a+=e}),n.on("exit",t=>{0==t?e():r({title:"\u9879\u76ee\u4f9d\u8d56\u5b89\u88c5\u5931\u8d25",message:a})})}):Promise.resolve()).then(()=>{t.info("generator process complete"),n(null,{path:s}),a({title:"\u521b\u5efa\u9879\u76ee\u5b8c\u6210",body:s})}).catch(e=>{n(e,{path:s})})}destroy(){}}module.exports=new s;